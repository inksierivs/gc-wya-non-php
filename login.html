<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login</title>
  <link rel="icon" type="image/png" href="pics/WYA-logo.png" />
  <link rel="stylesheet" href="css/login.css">
  </head>
<body>

  <img src="pics/WYA-logo.png" alt="WYA Logo" class="logo">

  <div class="login-container">
      <h2>Welcome!</h2>

    <label for="email">Domain Email</label>
    <input type="text" id="email" placeholder="Enter your email" />

    <label for="password">Password</label>
    <input type="password" id="password" placeholder="Enter your password" />

    <button id="login-button">Login</button>
    <a href="signup.html">Create new account</a>
  </div>

  <script type="module">
    import { loginUser } from './js/firebase-auth.js';

    document.getElementById("login-button").addEventListener("click", loginUser);



    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID"
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      // Get DOM elements
      const userNameEl = document.getElementById("userName");
      const userStatusEl = document.getElementById("userStatus");
      const userIDEl = document.getElementById("userID");
      const userEmailEl = document.getElementById("userEmail");

      auth.onAuthStateChanged(async (user) => {
        if (user) {
          userEmailEl.textContent = user.email;

          try {
            const docRef = db.collection("users").doc(user.uid);
            const doc = await docRef.get();

            if (doc.exists) {
              const data = doc.data();
              userNameEl.textContent = data.name || "No name";
              userIDEl.textContent = data.idNumber || "No ID";
              userStatusEl.textContent = data.status || "No status";
              document.getElementById("contactNumber").value = data.contactNumber || "";
            } else {
              console.log("No such document!");
            }
          } catch (error) {
            console.error("Error getting document:", error);
          }
        } else {
          window.location.href = "/login.html"; // redirect if not logged in
        }
      });

      function logout() {
        auth.signOut().then(() => {
          window.location.href = "/login.html";
        });
      }

      function updateContactNumber(event) {
        const number = event.target.value;
        const user = auth.currentUser;
        if (user) {
          db.collection("users").doc(user.uid).update({
            contactNumber: number
          });
        }
      }

      function updateHeaderPhoto(event) {
        // Add image uploading logic here (e.g. Firebase Storage)
        console.log("Header photo selected", event.target.files[0]);
      }

      function updateProfilePhoto(event) {
        // Add image uploading logic here (e.g. Firebase Storage)
        console.log("Profile photo selected", event.target.files[0]);
      }
      
  </script>
</body>
</html>
